<!-- NOT LOGGED IN -->
@if (!(clerk.user$ | async)) {
  <div class="auth-container">
    <h2>Sign in to SR&ED AI</h2>
    <clerk-sign-in></clerk-sign-in>
  </div>
}

<!-- LOGGED IN -->
@if (clerk.user$ | async; as user) {

  <!-- FLOATING NAVBAR -->
  <nav class="floating-nav">

    <div class="nav-left">
      <div class="brand" routerLink="/">
        <span class="dot"></span>
        <span class="brand-text">SR&ED AI</span>
      </div>

      <div class="nav-item" routerLink="/get-reports">
        View Reports
      </div>
    </div>

    <div class="nav-right">
      <div class="nav-user">
        <clerk-user-button></clerk-user-button>
        <div class="info">
          <div class="name">{{ user.firstName || user.username }}</div>
          <div class="email">{{ user.primaryEmailAddress?.emailAddress }}</div>
        </div>
      </div>
    </div>

  </nav>

  <!-- MAIN PAGE CONTENT -->
  <div class="main-content">

    <section class="section-head">
      <h3>Connect your tools</h3>
      <p>We use integrations to gather engineering activity for SR&ED reporting.</p>
    </section>

    <!-- INTEGRATION CARDS -->
    <div class="integration-list">

      <button
  class="integration-card"
  [class.connected]="githubConnected"
  [disabled]="githubConnected"
  (click)="!githubConnected && connectGitHub()"
>

  <div class="icn">
    @if (githubConnected) {
      âœ…
    } @else {
      ğŸ”—
    }
  </div>

  <div class="text">

    <div class="title">
      @if (githubConnected) {
        GitHub Connected
      } @else {
        Connect GitHub
      }
    </div>

    <div class="subtitle">
      @if (githubConnected) {
        Your GitHub account is linked
      } @else {
        Read repositories, commits & PR history
      }
    </div>

  </div>

</button>


      <button class="integration-card" (click)="connectJira()">
        <div class="icn">ğŸ”—</div>
        <div class="text">
          <div class="title">Connect Jira</div>
          <div class="subtitle">Read issues, sprints & engineering logs</div>
        </div>
      </button>

    </div>

    <!-- LOAD REPOS BUTTON -->
    <button class="load-repos-btn" (click)="loadRepos()">
      ğŸ“ Load My GitHub Repositories
    </button>

    <router-outlet></router-outlet>
  </div>
}
